<?phpclass guild {	private $sql;	private $res;	private $fet;	private $gid;	private $count;	private $GuildName;	private $Country;	private $Member;	private $GuildPoint;	private $CreateDate;	private $Remark;	private $LeaderCharName;	private $faction;	private $html;	private $link;		public function __construct($gid, $link){		$this->gid = $gid;		$this->link	= $link;		$this->sql = "SELECT [g].[GuildName], [g].[Country], [g].[TotalCount], [g].[GuildPoint], [g].[CreateDate], [gd].[Remark], [c].[CharName] FROM [PS_GameData].[dbo].[Guilds] AS [g]					  INNER JOIN [PS_GameData].[dbo].[GuildDetails] AS [gd] ON [gd].[GuildID] = [g].[GuildID]					  INNER JOIN [PS_GameData].[dbo].[Chars] AS [c] ON [c].[CharID] = [g].[MasterCharID]					  WHERE [g].[GuildID] = '$gid'					  ORDER BY [g].[GuildPoint] DESC, [g].[GuildName] ASC";		$this->res = odbc_exec($this->link, $this->sql);		$this->fet = odbc_fetch_array($this->res);		$this->GuildName		= $this->fet['GuildName'];		$this->Country			= $this->fet['Country'];		$this->Member			= $this->fet['TotalCount'];		$this->GuildPoint		= $this->fet['GuildPoint'];		$this->CreateDate		= $this->fet['CreateDate'];		$this->Remark			= $this->fet['Remark'];		$this->LeaderCharName	= $this->fet['CharName'];	}		public function getName(){		return $this->GuildName;	}		public function parseDate(){		$this->day = date('j', strtotime($this->CreateDate));		return $this->day.'th '.date('F Y, g:i a', strtotime($this->CreateDate));	}		public function getFactionRank(){		$this->sql = "SELECT [GuildID] FROM [PS_GameData].[dbo].[Guilds] WHERE [Country] = '".$this->Country."' AND [Del] = 0					  ORDER BY [GuildPoint] DESC";		$this->res = odbc_exec($this->link, $this->sql);				$this->count =  1;				while ($this->fet = odbc_fetch_array($this->res)){			if ($this->fet['GuildID'] == $this->gid)				break;						$this->count++;		}				return $this->count;	}		public function getRank(){		$this->sql = "SELECT [GuildID] FROM [PS_GameData].[dbo].[Guilds] WHERE [Del] = 0					  ORDER BY [GuildPoint] DESC";		$this->res = odbc_exec($this->link	, $this->sql);				$this->count =  1;				while ($this->fet = odbc_fetch_array($this->res)){			if ($this->fet['GuildID'] == $this->gid)				break;						$this->count++;		}				return $this->count;	}		public function getToolTipHtml(){		if ($this->Country == 0)			$this->faction = "Light";		else			$this->faction = "Dark";				$this->html =  '<font size=2>'.$this->GuildName.'</font><br>';		$this->html .= '<table>';		$this->html .= '<tr>';		$this->html .= '<td>Rank: </td><td>'.$this->getRank().'</td>';		$this->html .= '</tr>';		$this->html .= '<tr>';		$this->html .= '<td>Rank (faction): </td><td>'.$this->getFactionRank().'</td>';		$this->html .= '</tr>';		$this->html .= '<tr>';		$this->html .= '<td>GuildPoint: </td><td>'.$this->GuildPoint.'</td>';		$this->html .= '</tr>';		$this->html .= '<tr>';		$this->html .= '<td>Leader: </td><td>'.$this->LeaderCharName.'</td>';		$this->html .= '</tr>';		$this->html .= '<tr>';		$this->html .= '<td>Member: </td><td>'.$this->Member.'</td>';		$this->html .= '</tr>';		$this->html .= '<tr>';		$this->html .= '<td>Faction: </td><td>'.$this->faction.'</td>';		$this->html .= '</tr>';		$this->html .= '<tr>';		$this->html .= '<td>CreateDate: </td><td>'.$this->parseDate().'</td>';		$this->html .= '</tr>';		$this->html .= '<tr>';		$this->html .= '<td>Remark: </td><td>'.htmlspecialchars(preg_replace("/'/", '', preg_replace('/"/', '', $this->Remark))).'</td>';		$this->html .= '</tr>';		$this->html .= '</table>';				return $this->html;	}}?>